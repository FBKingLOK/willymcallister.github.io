<html>
<head>
  <style>
    #trig{margin:20px}
    .trig path{stroke:gold;stroke-width:4px;fill:none}
    .trig circle,
    .trig line{stroke:lime;stroke-width:2px;fill:none}
    .trig .axis{stroke:silver}
    .trig text{fill:silver;font-family:sans-serif;font-size:22}
</style>
</head>

<body>
<div id="sine-and-cosine"></div>
<script src="https://d3js.org/d3.v4.min.js"></script>
    
<script> 
(function () {

  var
    ID_TRIG = '#sine-and-cosine';

  var
    data    = [],
    height   = 760,
    width  = 760,
    ymin    = -2,
    ymax    = 7,
    domainH = ymax - ymin,
    rangeH  = height,
    rangeW  = width,
    domainW = domainH * (rangeW / rangeH),
    //xmax    = domainW / 2,
    //xmin    = -xmax,
    xmin    = -2,
    xmax    = 7,
    xScale  = d3.scaleLinear(),   //constructs a new linear scale with the default domain [0,1] to range [0,1] which produces a mapping of 1:1.
    yScale  = d3.scaleLinear(),
    vis     = d3.select(ID_TRIG).append('svg:svg'),
    decor   = vis.append('svg:g'),
    graph   = vis.append('svg:g'),
    bCos    = graph.append('svg:line'),
    bSin    = graph.append('svg:line'),
    c       = graph.append('svg:line'),
    circle  = graph.append('svg:circle'),
    pathCos = graph.append('svg:path'),
    pathSin = graph.append('svg:path'),
    dotCos  = graph.append('svg:circle'),
    dotSin  = graph.append('svg:circle'),
    label   = graph.append('svg:text'),
    cosine  = d3.line(),
    sine    = d3.line(),
    time    = 0,
    i;

  for (i = 0; i < 84; i++) {
    data.push(i * 10 / 84);   // data = 0  10/84  20/84  30/84 ... 83/84
  }

  xScale
    .domain([xmin, xmax])
    .range([0, width]);

  yScale
    .domain([ymin, ymax])
    .range([0, height]);

  vis
    .attr('width', width)
    .attr('height', height);
   
  cosine
    .y(function (d, i) { return yScale(d); })
    .x(function (d, i) { return xScale(Math.cos(d - time)); });

  sine
    .x(function (d, i) { return xScale(d); })
    .y(function (d, i) { return yScale(Math.sin(d - time)); });

  decor.append("rect")
    .attr("width", "100%")
    .attr("height", "100%")
    .attr("fill", "black");

  // X-Axis
  decor.append('svg:line')
    .attr('x1', xScale(xmin))
    .attr('y1', yScale(0))
    .attr('x2', xScale(xmax))
    .attr('y2', yScale(0))
    .style("stroke", "silver");

  // y-axis labels and ticks
  decor.append('svg:line')
    .attr('y1', yScale(Math.PI))
    .attr('x1', xScale(0))
    .attr('y2', yScale(Math.PI))
    .attr('x2', xScale(0) + 8)
    .style("stroke", "silver");                 //tick mark

  decor.append("svg:text")
    .text(String.fromCharCode(960))             //pi character
    .attr("y", Math.round(yScale(Math.PI)))
    .attr("x", (xScale(0)) + 24)
    .attr("text-anchor", "middle")
    .style("fill", "silver")
    .style('font-family', 'sans-serif')
    .style('font-size', '18px');

    decor.append('svg:line')
    .attr('y1', yScale(2*Math.PI))
    .attr('x1', xScale(0))
    .attr('y2', yScale(2*Math.PI))
    .attr('x2', xScale(0) + 8)
    .style("stroke", "silver");                 //tick mark

  decor.append("svg:text")
    .text("2" + String.fromCharCode(960))       //2pi character
    .attr("y", Math.round(yScale(2*Math.PI)))
    .attr("x", (xScale(0)) + 24)
    .attr("text-anchor", "middle")
    .style("fill", "silver")
    .style('font-family', 'sans-serif')
    .style('font-size', '18px');

  // Sine x-axis labels and ticks
  decor.append('svg:line')
    .attr('x1', xScale(Math.PI))
    .attr('y1', yScale(0))
    .attr('x2', xScale(Math.PI))
    .attr('y2', yScale(0) + 8)
    .style("stroke", "silver");                 //tick mark

  decor.append("svg:text")
    .text(String.fromCharCode(960))             //pi character
    .attr("x", Math.round(yScale(Math.PI)))
    .attr("y", (xScale(0)) + 24)
    .attr("text-anchor", "middle")
    .style("fill", "silver")
    .style('font-family', 'sans-serif')
    .style('font-size', '18px');

    decor.append('svg:line')
    .attr('x1', xScale(2*Math.PI))
    .attr('y1', yScale(0))
    .attr('x2', xScale(2*Math.PI))
    .attr('y2', yScale(0) + 8)
    .style("stroke", "silver");                 //tick mark

  decor.append("svg:text")
    .text("2" + String.fromCharCode(960))       //2pi character
    .attr("x", Math.round(xScale(2*Math.PI)))
    .attr("y", (yScale(0)) + 24)
    .attr("text-anchor", "middle")
    .style("fill", "silver")
    .style('font-family', 'sans-serif')
    .style('font-size', '18px');

  // Y-Axis
  decor.append('svg:line')
    .attr('x1', xScale(0))
    .attr('y1', yScale(ymin))
    .attr('x2', xScale(0))
    .attr('y2', yScale(ymax))
    .style("stroke", "silver");

  // Time
  label
    .attr("x", 2)
    .attr("y", 24)
    .style("fill", "silver")
    .style('font-family', 'sans-serif')
    .style('font-size', '18px');

  // Circle
  circle
    .attr('cx', xScale(0))
    .attr('cy', yScale(0))
    .attr('r', xScale(1) - xScale(0))
    .style("stroke", "silver")
    .style('stroke-width', '2px')
    .style("fill", "none");

  // Dot for cosine
  dotCos
    .attr('cy', yScale(0))
    .attr('r', 4)
    .style('fill', 'orange')
    .style('stroke', 'green');

  // Dot for sine
  dotSin
    .attr('cx', xScale(0))
    .attr('r', 4)
    .style('fill', 'gold')
    .style('stroke', 'green');

  // Rotating exponential vector
  c
    .attr('x1', xScale(0))
    .attr('y1', yScale(0));

  function draw() {

    var
      x = xScale(Math.cos(time)),
      y = yScale(-Math.sin(time));

    pathCos
      .attr('d', cosine(data))
      .style('fill', 'none')
      .style('stroke', 'orange')
      .style('stroke-width', '4px');
 
    pathSin
      .attr('d', sine(data))
      .style('fill', 'none')
      .style('stroke', 'gold')
      .style('stroke-width', '4px');

    //label
    //  .text('t = '+ Math.floor(time / Math.PI));

    c
      .attr('x2', x)          // rotating hypotenuse
      .attr('y2', y)
      .style('stroke', 'green')
      .style('stroke-width', '4px')
      .attr('stroke-linecap', "round");

    bCos
      .attr('x1', x)          // vertical projection line
      .attr('y1', yScale(0))
      .attr('x2', x)
      .attr('y2', y)
      .style('stroke', 'green')
      .style('stroke-width', '2px')
      .style("stroke-dasharray", ("3, 3"));

    bSin                      // horizontal projection line
      .attr('x1', xScale(0))
      .attr('y1', y)
      .attr('x2', x)
      .attr('y2', y)
      .style('stroke', 'green')
      .style('stroke-width', '2px')
      .style("stroke-dasharray", ("3, 3"));

    dotCos
      .attr('cx', x);

    dotSin
      .attr('cy', y);

    time += .06;

    setTimeout(draw, 35);
  }
  draw();

})();
</script>

</body>
</html>
